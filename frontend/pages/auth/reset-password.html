<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - User Management System</title>

    <!-- üõ°Ô∏è ENTERPRISE SECURITY HEADERS - 2025 STANDARDS -->

    <!-- ‚úÖ ENHANCED CSP: Complete protection suite -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self'; img-src 'self' data:; connect-src 'self'; form-action 'self'; base-uri 'self';">

    <!-- ‚úÖ MIME-sniffing protection -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">

    <!-- ‚úÖ Referrer policy for privacy -->
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">

    <!-- ‚úÖ DNS prefetch control for privacy -->
    <meta http-equiv="x-dns-prefetch-control" content="off">

    <!-- ‚úÖ Permissions policy for enhanced security -->
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">

    <!-- üîó EXTERNAL STYLES -->
    <link rel="stylesheet" href="../../assets/css/main.css">
    <link rel="stylesheet" href="../../assets/css/auth.css">
</head>
<body>
    <div class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <h1>üîí Reset Password</h1>
                <p>Enter your new password below</p>
            </div>

            <!-- Security notices and form content -->
            <div class="security-notice" id="securityNotice" style="display: none;">
                <strong>Security Notice:</strong> <span id="securityMessage"></span>
            </div>

            <div class="rate-limit-warning" id="rateLimitWarning" style="display: none;">
                <strong>‚ö†Ô∏è Too many attempts:</strong> Please wait <span id="rateLimitCountdown">60</span> seconds before trying again.
            </div>

            <div id="messageContainer"></div>

            <div id="resetFormContainer">
                <form id="resetPasswordForm" class="auth-form" novalidate>
                    <div class="form-group">
                        <label for="password">New Password:</label>
                        <input
                            type="password"
                            id="password"
                            name="password"
                            required
                            autocomplete="new-password"
                            minlength="8"
                            maxlength="128"
                            title="Password must meet security requirements"
                            data-validate="password"
                        >
                        <button type="button" class="password-toggle" id="passwordToggle" tabindex="-1">
                            üëÅÔ∏è
                        </button>
                        <div class="validation-message" id="passwordValidation"></div>
                    </div>

                    <div class="form-group">
                        <label for="confirmPassword">Confirm New Password:</label>
                        <input
                            type="password"
                            id="confirmPassword"
                            name="confirmPassword"
                            required
                            autocomplete="new-password"
                            minlength="8"
                            maxlength="128"
                            title="Please confirm your new password"
                            data-validate="confirmPassword"
                        >
                        <button type="button" class="password-toggle" id="confirmPasswordToggle" tabindex="-1">
                            üëÅÔ∏è
                        </button>
                        <div class="validation-message" id="confirmPasswordValidation"></div>
                    </div>

                    <div class="password-requirements">
                        <h4>Password Requirements:</h4>
                        <ul>
                            <li id="req-length">8-100 characters long</li>
                            <li id="req-case">Contains uppercase and lowercase letters</li>
                            <li id="req-number">Contains at least one number</li>
                            <li id="req-special">Contains at least one special character (!@#$%^&*)</li>
                        </ul>
                        <div id="passwordErrors" class="password-errors"></div>
                    </div>

                    <button type="submit" class="auth-btn" id="resetBtn">
                        <span class="loading-spinner" id="loadingSpinner"></span>
                        <span id="buttonText">Reset Password</span>
                    </button>
                </form>

                <div class="token-info">
                    <strong>‚ö†Ô∏è Security Notice:</strong> This reset link will expire in 1 hour for your security.
                </div>
            </div>

            <div id="successContainer" style="display: none;">
                <div class="message success">
                    <strong>‚úÖ Password Reset Successful!</strong><br>
                    Your password has been changed successfully. You can now log in with your new password.
                </div>
            </div>

            <div class="auth-links">
                <a href="login.html" id="loginLink">‚Üê Back to Login</a>
            </div>

            <p style="margin-top: 30px;">
                <a href="../../index.html" class="back-link">‚Üê Back to Home</a>
            </p>
        </div>
    </div>

    <!-- üîí SECURE EXTERNAL SCRIPTS -->
    <script src="../../assets/js/config.js"></script>
    <script src="../../assets/js/logger.js"></script>
    <script src="../../assets/js/main.js"></script>
    <script src="../../assets/js/auth.js"></script>
    <script src="../../assets/js/reset-password.js"></script>
</body>
</html>